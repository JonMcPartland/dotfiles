#!/usr/bin/env bash

isInGit() {
  local GITINFO=()

  GITINFO+=($(git rev-parse --is-inside-work-tree 2> /dev/null))

  local BRANCH=$(git symbolic-ref HEAD 2> /dev/null | sed -e 's/refs\/heads\///')
  local HASH=$(git show --oneline -s | awk '{print $1}')

  if [ "$BRANCH" ]; then
    GITINFO+=("$BRANCH")
  else
    GITINFO+=("$HASH")
  fi

  GITINFO+=($(git status --porcelain 2> /dev/null | tail -n1))

  for I in "${!GITINFO[@]}"; do
    if [[ "${GITINFO[$I]}" == *"Not a git repository"* ]]; then
      GITINFO["$I"]=""
    fi
  done

  printf '%s ' "${GITINFO[@]}"
}
